import type { Metadata } from 'next';
import './globals.css';
import React from 'react';
import { ThemeModeScript } from 'flowbite-react';

import { robotoMedium } from '@/font/font';
import { AlertBox } from '@/component/elements/message-box';
import { MenuNavbar } from '@/component/header/nav';
import InitUser from '@/component/elements/init-user';
import { httpGet } from '@/lib/api-module';
import { UserType } from '@/type/login/loginType';

export const metadata: Metadata = {
    title: {
        template: '%s | first-next',
        default: 'first-next'
    },
    description: 'Generated by create next app'
};

export default async function RootLayout({ children }: Readonly<{ children: React.ReactNode }>) {
    const user = await httpGet<UserType | null>('/user/token-user');

    if (user) {
        if (!user.picture) {
            user.picture = '/images/default-user.png';
        }
    }
    return (
        <html lang="en" suppressHydrationWarning>
            <head>
                <ThemeModeScript />
            </head>
            <body className={`${robotoMedium.className} antialiased`}>
                <InitUser user={user} />
                <MenuNavbar />
                <AlertBox />
                {children}
            </body>
        </html>
    );
}
